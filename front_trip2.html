<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>STEP2: AI提案 | NEWT biz BTM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui"] },
            colors: {
              rt: {
                50: '#ECFDF5',
                100: '#D1FAE5',
                200: '#A7F3D0',
                300: '#6FE7B0',
                400: '#2EDB7B',
                500: '#04cd68ff',
                600: '#03B75E',
                700: '#029E52',
                800: '#028546',
                900: '#016C39'
              }
            },
            boxShadow: { card: "0 6px 24px rgba(0,0,0,0.08)" }
          }
        }
      };
    </script>
    <style> html { scroll-behavior: smooth } body { background:#F6F6F6 } </style>
  </head>
  <body class="antialiased text-slate-800">
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const Container = ({ children, className = "" }) => (
        <div className={`mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8 ${className}`}>{children}</div>
      );

      const Header = () => {
        const steps = ["要件入力", "AI提案", "微調整", "承認申請", "上司承認"]; const currentStep = 2;
        return (
          <header className="bg-white/80 backdrop-blur sticky top-0 z-50 border-b border-slate-200">
            <Container className="flex items-center justify-between h-16">
              <a href="index.html" className="font-bold tracking-tight text-lg">NEWT biz BTM</a>
              <div className="hidden md:flex items-center gap-4">
                {steps.map((s,i)=> (
                  <div key={s} className="flex items-center gap-2">
                    <span className={`flex items-center justify-center w-6 h-6 rounded-full font-bold text-sm ${i+1===currentStep?'bg-rt-600 text-white':'bg-slate-200 text-slate-500'}`}>{i+1}</span>
                    <span className={`${i+1===currentStep?'text-rt-600':'text-slate-500'} font-semibold`}>{s}</span>
                    {i<steps.length-1 && <div className="w-10 h-0.5 bg-slate-200"/>}
                  </div>
                ))}
              </div>
              <div className="flex items-center gap-4 text-sm"><span className="font-semibold">P-NEWT-042</span><span className="bg-slate-100 px-2 py-1 rounded-md">出張者</span></div>
            </Container>
          </header>
        );
      };

      const Status = ({state}) => (
        <div className="rounded-md bg-slate-50 border border-slate-200 px-3 py-2 text-sm">
          {state==='loading' && <span>要件を反映中… AIが最適な3案を作成しています。</span>}
          {state==='ready' && <span className="text-rt-700 font-semibold">3件の提案が生成されました</span>}
        </div>
      );

      const PlanCard = ({plan, onChoose}) => (
        <div className="bg-white rounded-xl border border-slate-200 shadow-card p-6 flex flex-col h-full min-h-[420px]">
          <div className="grid grid-cols-[1fr,auto] gap-3 items-start min-h-[56px]">
            <h3 className="text-xl font-extrabold leading-tight">{plan.title}</h3>
            <span className={`text-xs rounded-full px-3 py-1 ${plan.policy.ok? 'bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200':'bg-amber-50 text-amber-700 ring-1 ring-amber-200'}`}>{plan.policy.label}</span>
          </div>
          <div className="mt-4 grid grid-cols-1 gap-2 text-sm">
            <div className="rounded-lg border border-slate-200 p-3 h-14 w-full flex items-center justify-between">
              <div className="text-xs text-slate-500">総額</div>
              <div className="font-semibold">¥{plan.total.toLocaleString()}</div>
            </div>
            <div className="rounded-lg border border-slate-200 p-3 h-14 w-full flex items-center justify-between">
              <div className="text-xs text-slate-500">所要</div>
              <div className="font-semibold">{plan.duration}</div>
            </div>
            <div className="rounded-lg border border-slate-200 p-3 h-14 w-full flex items-center justify-between">
              <div className="text-xs text-slate-500">適合度</div>
              <div className="font-semibold">{plan.score}%</div>
            </div>
          </div>
          <ul className="mt-4 text-sm text-slate-700 space-y-2 list-disc pl-5 flex-1">
            <li>{plan.flight}</li>
            <li>{plan.hotel}</li>
            <li>{plan.extras}</li>
          </ul>
          <button onClick={()=>onChoose(plan)} className="mt-4 rounded-md bg-rt-600 px-4 py-2 text-white font-semibold hover:bg-rt-700">採用して編集へ</button>
        </div>
      );

      const PDFPanel = () => {
        const file = '【完全版】三井物産社員_台湾旅行.pdf';
        return (
          <div className="bg-white rounded-xl border border-slate-200 shadow-card p-4 h-[640px]">
            <div className="text-sm font-semibold">PDFプレビュー</div>
            <div className="mt-3 h-[580px] w-full rounded overflow-hidden">
              <embed src={file} type="application/pdf" className="w-full h-full" />
            </div>
            <div className="mt-2 text-xs text-slate-500 text-left">ファイルが表示されない場合は <a href={file} className="underline text-rt-700" target="_blank">新しいタブで開く</a></div>
          </div>
        );
      };

      const Footer = ({onBack, onRegen, onNext}) => (
        <footer className="bg-white/80 backdrop-blur sticky bottom-0 z-50 border-t border-slate-200 py-3">
          <Container className="flex items-center justify-between">
            <button onClick={onBack} className="rounded-md px-4 py-2 text-sm font-semibold border border-slate-300 hover:bg-slate-100">戻る</button>
            <div className="flex items-center gap-2 text-sm">
              <label className="flex items-center gap-1"><input type="checkbox" id="opt1" className="accent-rt-600"/>直行優先</label>
              <label className="flex items-center gap-1"><input type="checkbox" id="opt2" className="accent-rt-600"/>夜便回避</label>
              <button onClick={onRegen} className="rounded-md px-4 py-2 font-semibold text-slate-600 hover:text-slate-900">別条件で再提案</button>
            </div>
            <button onClick={onNext} className="rounded-md bg-rt-600 px-6 py-2 text-white font-semibold shadow hover:bg-rt-700">採用して微調整へ</button>
          </Container>
        </footer>
      );

      const App = () => {
        const [state, setState] = React.useState('loading');
        const [plans, setPlans] = React.useState([]);

        React.useEffect(()=>{
          const timer = setTimeout(()=>{
            setPlans([
              { id:'cost', title:'コスパ重視', total: 126800, duration:'6h40m', score: 92, flight:'ANA2451 06:50→08:35 直行', hotel:'札幌駅前ビジネス 1泊¥11,800 素泊', extras:'配車手配なし', policy:{ok:true,label:'予算内・ポリシーOK'} },
              { id:'balance', title:'バランス重視', total: 139200, duration:'6h10m', score: 88, flight:'JAL687 08:00→09:50 直行', hotel:'大通パークサイド 1泊¥12,750 朝食', extras:'地下鉄移動', policy:{ok:true,label:'予算内・ポリシーOK'} },
              { id:'comfort', title:'快適重視', total: 182400, duration:'5h50m', score: 80, flight:'ANA2451 06:50→08:35 プレミアム', hotel:'シティホテル 上層階 1泊¥18,800 朝食', extras:'配車手配あり', policy:{ok:false,label:'10%超（要エスカレーション）'} },
            ]);
            setState('ready');
          }, 1000);
          return ()=>clearTimeout(timer);
        },[]);

        const choose = (p) => {
          localStorage.setItem('chosenPlan', JSON.stringify(p));
          window.location.href = 'middle_trip.html'; // 次ページ（STEP3仮）
        };

        return (
          <div className="flex flex-col min-h-screen">
            <Header />
            <main className="flex-grow w-full">
              <Container className="py-6 pb-28">
                <Status state={state} />
                <div className="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
                  <div className="lg:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-6 items-stretch">
                    {plans.map(p => <PlanCard key={p.id} plan={p} onChoose={choose} />)}
                  </div>
                  <div>
                    <PDFPanel />
                  </div>
                </div>
              </Container>
            </main>
            <Footer onBack={()=>history.back()} onRegen={()=>location.reload()} onNext={()=>{ const p = plans[1]||plans[0]; choose(p); }} />
          </div>
        );
      };

      ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
  </body>
</html>


